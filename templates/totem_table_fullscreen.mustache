{{!
	This file is part of Moodle - http://moodle.org/

	Moodle is free software: you can redistribute it and/or modify
	it under the terms of the GNU General Public License as published by
	the Free Software Foundation, either version 3 of the License, or
	(at your option) any later version.

	Moodle is distributed in the hope that it will be useful,
	but WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
	GNU General Public License for more details.

	You should have received a copy of the GNU General Public License
	along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
	@template block_totem/totem_table
	
	Show totem as a table
}}
<div id="totem-element-{{date}}" class="totem-table">
	<h3 id="totem-title-{{date}}">{{date_text}}</h3>
	<div id="totem-scroll-{{date}}">
		<table id="totem-table-{{date}}" class="generaltable hidden">
			{{#records}}
				<tr>
				<td class="cell c0" width="40rem">{{eventtype}}</td>
				<td class="cell c1" width="80rem">{{idnumber}}</td>
				<td class="cell c2" width="80rem">{{subject}}</td>
				<td class="cell c3" width="80rem">{{section}}</td>
				<td class="cell c4" width="80rem">{{time}}</td>
				<td class="cell c5">{{displaytext}}</td>
				</tr>
			{{/records}}
		</table>
	</div>	
	<div id="totem-msg-{{date}}">

	</div>
</div>
{{#js}}
	document.getElementById("totem-scroll-{{date}}").style.height = (document.getElementById("totem-element-fullscreen").offsetHeight - document.getElementById("totem-title-{{date}}").offsetHeight - document.getElementById("totem-msg-{{date}}").offsetHeight) + "px";
	document.getElementById("totem-scroll-{{date}}").style.overflow = "hidden";
	document.getElementById("totem-table-{{date}}").classList.remove('hidden');

	var sto = setInterval(scroll, 2500);
	
	var scrollItem = 0
	
	function scroll() {
		document.getElementById("totem-table-{{date}}").children[0].children[scrollItem].scrollIntoView();
		scrollItem++;
		if (document.getElementById("totem-table-{{date}}").children[0].children.length == scrollItem ) {
			clearTimeout(sto);
			require(['block_totem/get_ajax_totemtable'], function(totemtable) {
				totemtable.load({{date}}, {{index}}, {{limit}});
			});
		}
	}
{{/js}}