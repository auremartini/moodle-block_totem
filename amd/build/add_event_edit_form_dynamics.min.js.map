{"version":3,"sources":["../src/add_event_edit_form_dynamics.js"],"names":["define","init","params","document","getElementById","innerHTML","option","createElement","value","text","add","list","eventypelist","split","forEach","item","style","addEventListener","getElementsByName","element","dispatchEvent","Event","require","$","ajax","notification","promises","call","methodname","args","source","parseInt","sourceid","done","response","id","firstname","lastname","promises2","blockteachings","teacherid","response2","name","length","d","fail","exception"],"mappings":"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","sourcesContent":["/**\n * @module    block_totem/add_event_edit_form_dynamics\n * @package   block_totem\n * @copyright 2020 Aureliano Martini\n * @licence   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since     3.0\n */\n\ndefine(['jquery'], function() {\n    return {\n        init: function(params) {\n            //Event type list\n            document.getElementById('id_eventtypelist').innerHTML = \"\";\n            var option = document.createElement(\"option\");\n            option.value = '';\n            option.text = '';\n            document.getElementById('id_eventtypelist').add(option);\n\n            var list = params.eventypelist.split('\\n');\n            list.forEach(function(item) {\n                var params = item.split('|');\n                var option = document.createElement(\"option\");\n                option.value = params[0];\n                option.text = params[1];\n                option.style = params[2];\n                document.getElementById('id_eventtypelist').add(option);\n            });\n\n            document.getElementById('id_eventtypelist').addEventListener('change', function(){\n                document.getElementsByName('eventtype')[0].value = document.getElementById(\"id_eventtypelist\").value;\n            });\n\n            if (document.getElementsByName('eventtype')[0].value != '') {\n                var element = document.getElementById(\"id_eventtypelist\");\n                element.value = document.getElementsByName('eventtype')[0].value;\n                element.dispatchEvent(new Event('change'));\n            }\n\n            //Teacher list\n            require(['jquery', 'core/ajax', 'core/notification'], function($, ajax, notification) {\n                var promises = ajax.call([\n                    {\n                        methodname: 'get_userlist',\n                        args: { source: parseInt(params.source + \"\"), sourceid: parseInt(params.sourceid + \"\") }\n                    }\n                ]);\n                promises[0].done(function(response) {\n                    document.getElementById('id_useridlist').innerHTML = \"\";\n                    var option = document.createElement(\"option\");\n                    option.value = '';\n                    option.text = '';\n                    document.getElementById('id_useridlist').add(option);\n                    response.forEach(function(item) {\n                        var option = document.createElement(\"option\");\n                        option.value = item.id;\n                        option.text = item.firstname + \" \" + item.lastname;\n                        document.getElementById('id_useridlist').add(option);\n                    });\n                    document.getElementById('id_useridlist').addEventListener('change', function(){\n                        document.getElementsByName('userid')[0].value = document.getElementById(\"id_useridlist\").value;\n                        if (document.getElementsByName('teaching')[0].value != '') {\n                            document.getElementsByName('teaching')[0].value = '-';\n                        }\n                        var promises2 = ajax.call([\n                            {\n                                methodname: 'get_teachinglist',\n                                args: {\n                                    blockteachings: String(params.blockteachings),\n                                    teacherid: parseInt(document.getElementById(\"id_useridlist\").value + '')\n                                }\n                            }\n                        ]);\n                        promises2[0].done(function(response2) {\n                            document.getElementById('id_teachinglist').innerHTML = \"\";\n                            var option = document.createElement(\"option\");\n                            option.value = '';\n                            option.text = '';\n                            document.getElementById('id_teachinglist').add(option);\n                            response2.forEach(function(item) {\n                                var option = document.createElement(\"option\");\n                                option.value = item.id;\n                                option.text = item.name;\n                                document.getElementById('id_teachinglist').add(option);\n                            });\n                            if (document.getElementsByName('id')[0].value == '0') {\n                                if (response2.length > 0) {\n                                    document.getElementsByName('teaching')[0].value = response2[0].id;\n                                    document.getElementById(\"id_teachinglist\").value = response2[0].id;\n                                }\n                            } else {\n                                var d = document.getElementById(\"id_teachinglist\");\n                                if (document.getElementsByName('teaching')[0].value == '') {\n                                    d.value = document.getElementsByName('teaching')[0].value;\n                                } else {\n                                    d.value = document.getElementsByName('teaching')[0].value;\n                                    if (document.getElementById(\"id_teachinglist\").value == '') {\n                                        document.getElementsByName('teaching')[0].value = response2[0].id;\n                                        document.getElementById(\"id_teachinglist\").value = response2[0].id;\n                                    }\n                                }\n                            }\n                            document.getElementById('id_teachinglist').addEventListener('change', function(){\n                                document.getElementsByName('teaching')[0].value = document.getElementById(\"id_teachinglist\").value;\n                            }, false);\n                        }).fail(notification.exception);\n                    }, false);\n                    if (document.getElementsByName('userid')[0].value != '') {\n                        var element = document.getElementById(\"id_useridlist\");\n                        element.value = document.getElementsByName('userid')[0].value;\n                        element.dispatchEvent(new Event('change'));\n                    }\n                }).fail(notification.exception);\n             });\n        }\n    };\n});"],"file":"add_event_edit_form_dynamics.min.js"}