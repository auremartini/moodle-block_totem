{"version":3,"sources":["../src/add_event_edit_form_dynamics.js"],"names":["define","init","params","require","$","ajax","notification","promises","call","methodname","args","source","parseInt","sourceid","done","response","document","getElementById","innerHTML","option","createElement","value","text","add","forEach","item","id","firstname","lastname","addEventListener","getElementsByName","promises2","blockteachings","teacherid","response2","name","length","d","fail","exception","element","dispatchEvent","Event"],"mappings":"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","sourcesContent":["/**\n * @module    block_totem/add_event_edit_form_dynamics\n * @package   block_totem\n * @copyright 2020 Aureliano Martini\n * @licence   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since     3.0\n */\n\ndefine(['jquery'], function() {\n    return {\n        init: function(params) {\n            //@todo in collegamento con il problema della definizione dei tipi di evento in admin settings\n            //document.getElementById('id_eventtype').children[1].style.color = \"red\";\n            require(['jquery', 'core/ajax', 'core/notification'], function($, ajax, notification) {\n                var promises = ajax.call([\n                    {\n                        methodname: 'get_userlist',\n                        args: { source: parseInt(params.source + \"\"), sourceid: parseInt(params.sourceid + \"\") }\n                    }\n                ]);\n                promises[0].done(function(response) {\n                    document.getElementById('id_useridlist').innerHTML = \"\";\n                    var option = document.createElement(\"option\");\n                    option.value = '';\n                    option.text = '';\n                    document.getElementById('id_useridlist').add(option);\n                    response.forEach(function(item) {\n                        var option = document.createElement(\"option\");\n                        option.value = item.id;\n                        option.text = item.firstname + \" \" + item.lastname;\n                        document.getElementById('id_useridlist').add(option);\n                    });\n                    document.getElementById('id_useridlist').addEventListener('change', function(){\n                        document.getElementsByName('userid')[0].value = document.getElementById(\"id_useridlist\").value;\n                        if (document.getElementsByName('teaching')[0].value != '') {\n                            document.getElementsByName('teaching')[0].value = '-';\n                        }\n                        var promises2 = ajax.call([\n                            {\n                                methodname: 'get_teachinglist',\n                                args: {\n                                    blockteachings: String(params.blockteachings),\n                                    teacherid: parseInt(document.getElementById(\"id_useridlist\").value + '')\n                                }\n                            }\n                        ]);\n                        promises2[0].done(function(response2) {\n                            document.getElementById('id_teachinglist').innerHTML = \"\";\n                            var option = document.createElement(\"option\");\n                            option.value = '';\n                            option.text = '';\n                            document.getElementById('id_teachinglist').add(option);\n                            response2.forEach(function(item) {\n                                var option = document.createElement(\"option\");\n                                option.value = item.id;\n                                option.text = item.name;\n                                document.getElementById('id_teachinglist').add(option);\n                            });\n                            if (document.getElementsByName('id')[0].value == '0') {\n                                if (response2.length > 0) {\n                                    document.getElementsByName('teaching')[0].value = response2[0].id;\n                                    document.getElementById(\"id_teachinglist\").value = response2[0].id;\n                                }\n                            } else {\n                                var d = document.getElementById(\"id_teachinglist\");\n                                if (document.getElementsByName('teaching')[0].value == '') {\n                                    d.value = document.getElementsByName('teaching')[0].value;\n                                } else {\n                                    d.value = document.getElementsByName('teaching')[0].value;\n                                    if (document.getElementById(\"id_teachinglist\").value == '') {\n                                        document.getElementsByName('teaching')[0].value = response2[0].id;\n                                        document.getElementById(\"id_teachinglist\").value = response2[0].id;\n                                    }\n                                }\n                            }\n                            document.getElementById('id_teachinglist').addEventListener('change', function(){\n                                document.getElementsByName('teaching')[0].value = document.getElementById(\"id_teachinglist\").value;\n                            }, false);\n                        }).fail(notification.exception);\n                    }, false);\n                    if (document.getElementsByName('userid')[0].value != '') {\n                        var element = document.getElementById(\"id_useridlist\");\n                        element.value = document.getElementsByName('userid')[0].value;\n                        element.dispatchEvent(new Event('change'));\n                    }\n                }).fail(notification.exception);\n             });\n        }\n    };\n});"],"file":"add_event_edit_form_dynamics.min.js"}